var literalStrings;function crunch(d){var b,a;var c;d.elements.codeOut.value="";d.elements.statusMsg.value="进行中...";b=d.elements.codeIn.value;a=b;d.elements.statusMsg.value="替换字符串...";a=replaceLiteralStrings(a);d.elements.statusMsg.value="去掉注释...";a=removeComments(a);d.elements.statusMsg.value="压缩空格...";a=compressWhiteSpace(a);d.elements.statusMsg.value="连接字符串...";a=combineLiteralStrings(a);d.elements.statusMsg.value="恢复字符串...";a=restoreLiteralStrings(a);d.elements.statusMsg.value="完成.";d.elements.codeOut.value=a;d.elements.sizeIn.value=b.length;d.elements.sizeOut.value=a.length;d.elements.sizeDiff.value=b.length-a.length;if(b.length>0){d.elements.pctOut.value=100-Math.round(a.length/b.length*10000)/100}return false}function replaceLiteralStrings(k){var e,f,h,l,a,b,d,g;literalStrings=new Array();h="";l=k.split("\n");for(e=0;e<l.length;e++){j=0;d=false;while(j<=l[e].length){f=l[e].charAt(j);if(!d){if(f=='"'||f=="'"){d=true;a=false;b=f;g=f}else{h+=f}}else{if(f==b&&!a){d=false;g+=b;h+="__"+literalStrings.length+"__";literalStrings[literalStrings.length]=g}else{if(f=="\\"&&!a){a=true}else{a=false}}g+=f}j++}h+="\n"}return h}function removeComments(d){var a,c,b;a=d.split("\n");b="";for(c=0;c<a.length;c++){b+=a[c].replace(/([^\x2f]*)\x2f\x2f.*$/,"$1")}b=b.replace(/(.*)\n(.*)/g,"$1 $2");a=b.split("*/");b="";for(c=0;c<a.length;c++){b+=a[c].replace(/(.*)\x2f\x2a(.*)$/g,"$1 ")}return b}function compressWhiteSpace(a){a=a.replace(/\s+/g," ");a=a.replace(/^\s(.*)/,"$1");a=a.replace(/(.*)\s$/,"$1");a=a.replace(/\s([\x21\x25\x26\x28\x29\x2a\x2b\x2c\x2d\x2f\x3a\x3b\x3c\x3d\x3e\x3f\x5b\x5d\x5c\x7b\x7c\x7d\x7e])/g,"$1");a=a.replace(/([\x21\x25\x26\x28\x29\x2a\x2b\x2c\x2d\x2f\x3a\x3b\x3c\x3d\x3e\x3f\x5b\x5d\x5c\x7b\x7c\x7d\x7e])\s/g,"$1");return a}function combineLiteralStrings(b){var a;b=b.replace(/"\+"/g,"");b=b.replace(/'\+'/g,"");return b}function restoreLiteralStrings(b){var a;for(a=0;a<literalStrings.length;a++){b=b.replace(new RegExp("__"+a+"__"),literalStrings[a])}return b};